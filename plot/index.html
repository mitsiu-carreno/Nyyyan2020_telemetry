
<!DOCTYPE html>
<html>
  <head>
    <title>Nyyyyan</title>

    <script src="/socket.io/socket.io.js"></script>
    <script src="canvasjs/canvasjs.min.js"></script>
    <script>

      var socket = io();

      window.onload = function(){
        var dataPoints = [];

        var chart = new CanvasJS.Chart("chartContainer",{
          theme: "light2",
          title: {
            text: "Acelerador"
          },
          data: [{
            type: "line",
            dataPoints: dataPoints
          }]
        });

        chart.render();

        // Socket
        socket.on('new_data', function(type, data) {
          console.log("received");
          if(type == "new_lap"){
            console.log("CLEAR")
            dataPoints.length = 0;
            //dataPoints.splice(0, dataPoints.length);
            chart.render();
          }
          if(type == "plot_data" && data.length > 0){
            //console.log(data);
            let test = data.split(",");
            if(Number(test[0])){
              //console.log("ploting ", Number(test[1]), Number(test[5]));
              dataPoints.push({x: Number(test[1]), y:Number(test[5])})
              chart.render();
            }
          }
        });
      }
    </script>
  </head>
  <body>
    <div id="chartContainer" style="height: 200px; width: 100%;"></div>
  </body>
</html>

